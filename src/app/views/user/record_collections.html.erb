<div class="m-account-page m-account-page--records-collections">

  <div class="wrap">
    <div class="section section--records">
      <h2>Your records</h2>
      <ul>
        <% current_user.records.each do |record| %>
          <li>
            <a href="#" class="clickable" data-type="record" data-id="<%= record.id %>"><%= record.title %></a>
            <button class="edit">Edit</button>
            <span class="draft-indicator"><%= record.state %></span>
          </li>
        <% end %>
      </ul>
    </div>

    <div class="section section--collections">
      <h2>Your collections</h2>
      <h3>Created by you</h3>
      <ul class="created-by-you">
        <% current_user.collections.each do |collection | %>
          <li>
            <a href="#" class="clickable" data-type="collection" data-id="<%= collection.id %>">
              <%= collection.title %>
            </a>
            <button class="edit">Edit</button>
          </li>
        <% end %>
      </ul>
      <h3>Created by your teams</h3>
      <ul>
        <% current_user.team_collections_granted.each do |collection | %>
          <li>
            <a href="#" class="clickable" data-type="collection" data-id="<%= collection.id %>">
              <%= collection.title %>
            </a>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>

<script>
    window.onload = function() {
        var targetOrigin = window.location.protocol +'//' + window.location.host;
        var anchors = document.getElementsByClassName('clickable');
        for(var i = 0; i < anchors.length; i++) {
            var anchor = anchors[i];
            anchor.onclick = function() {
                parent.postMessage(
                    {
                        'scope': 'clickable-iframe-element',
                        'type': this.dataset.type,
                        'id': this.dataset.id
                    },
                    targetOrigin
                );
            }
        }
    }
</script>